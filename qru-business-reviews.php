<?php/** * @link              https://www.quicklyreviewus.com/review-scan/ * @package           Qru_Business_Reviews * @wordpress-plugin *//*Plugin Name:       Business ReviewsPlugin URI:        https://www.quicklyreviewus.com/business-reviews-free-wordpress-plugin/Description:       Run unlimited free business review reports showing reviews across all major sites, your aggregate rating, public sentiment about your company, ratings distribution, total number of reviews, number of reviews by site and much more.Version:           2.5.0Author:            QuickyReviewUs.comAuthor URI:        https://www.quicklyreviewus.comLicense:           GPL-2.0+License URI:       http://www.gnu.org/licenses/gpl-2.0.txtText Domain:       qru-business-reviewsDomain Path:       /languages */// If this file is called directly, abort.if ( ! defined( 'WPINC' ) ) {	die;}/* * Assign Global Variable*/$qru_business_plugin_url = WP_PLUGIN_URL . '/qru-business-reviews';$options = array();/* * Adds a link to the Admin Menu for the Plugin settings. * This link is located at 'Settings > Local SEO' *//** * Plugin Menus */ function qru_business_scan_menu() {	add_menu_page( 'Review Scan', 'Review Scan', 'manage_options', 'qru-business-scan', 'qru_business_scan_options' );}add_action( 'admin_menu', 'qru_business_scan_menu' );function qru_review_page_menu() {	global $review_page_settings;	$review_page_settings = add_submenu_page( 'qru-business-scan', 'Review Page', 'Review Page', 'manage_options', 'qru-review-page', 'qru_review_page_options_page' );}add_action( 'admin_menu', 'qru_review_page_menu' );function qru_review_stream_menu() {	global $review_stream_settings;	$review_stream_settings = add_submenu_page( 'qru-business-scan', 'Review Stream', 'Review Stream', 'manage_options', 'qru-business', 'qru_review_stream_options_page' );}add_action( 'admin_menu', 'qru_review_stream_menu' );function qru_review_reporting_menu() {	global $review_reporting_settings;	$review_reporting_settings = add_submenu_page( 'qru-business-scan', 'Review Reporting', 'Review Reporting', 'manage_options', 'qru-review-reporting', 'qru_review_reporting_options_page' );}add_action( 'admin_menu', 'qru_review_reporting_menu' );/* * Review Scan Admin Page Content*/function qru_business_scan_options() {	if ( !current_user_can( 'manage_options' ) )  {		wp_die( __( 'You do not have sufficient permissions to access this page.' ) );	}	include( plugin_dir_path( __FILE__ ) . 'includes/qru-review-scan.php');}/* * Review Reporting*/function qru_review_reporting_options_page() {	if ( !current_user_can( 'manage_options' ) )  {		wp_die( __( 'You do not have sufficient permissions to access this page.' ) );	}	include( plugin_dir_path( __FILE__ ) . 'includes/qru-review-reporting.php');}/* * Review Stream Admin Page Content*/function qru_review_stream_options_page() {		if( !current_user_can( 'manage_options' ) ) {		wp_die( 'You do not have sufficient permissions to access this page.' );	}		global $qru_business_plugin_url;	global $options;	         if( !empty($_POST) && check_admin_referer('', 'qru_business_form_submitted' ) ) {                $qru_review_stream_url 		= esc_url( $_POST['qru_review_stream_url'] );                $qru_number_reviews 	= isset($_POST['qru_number_reviews'])?intval( $_POST['qru_number_reviews'] ):0;                $qru_carousel	= (isset( $_POST['qru_carousel'] ) && $_POST['qru_carousel'] == 'false')?'false':'true';                $qru_shuffle	= (isset( $_POST['qru_shuffle'] ) && $_POST['qru_shuffle'] == 'false')?'false':'true';                $qru_aggregate	= (isset( $_POST['qru_aggregate'] ) && $_POST['qru_aggregate'] == 'false')?'false':'true';                $options['qru_review_stream_url']			= $qru_review_stream_url;                $options['qru_number_reviews']		= $qru_number_reviews;                $options['qru_carousel']		= $qru_carousel;                $options['qru_shuffle']		= $qru_shuffle;                $options['qru_aggregate']		= $qru_aggregate;                $options['last_updated']				= time();                update_option( 'qru_business_options', $options );        }		$options = get_option( 'qru_business_options' );	if( $options != '' ) {				$qru_review_stream_url = $options['qru_review_stream_url'];		$qru_number_reviews = $options['qru_number_reviews'];		$qru_carousel = $options['qru_carousel'];		$qru_shuffle = $options['qru_shuffle'];		$qru_aggregate = $options['qru_aggregate'];		}		require( 'includes/qru-review-stream.php' );	}/* * Review Page Content*/function qru_review_page_options_page() {		if( !current_user_can( 'manage_options' ) ) {		wp_die( 'You do not have sufficient permissions to access this page.' );	}		global $qru_business_plugin_url;	global $options;	        if( !empty($_POST) && check_admin_referer('', 'qru_business_page_form_submitted' ) ) {                $qru_review_page_url 		= esc_url( $_POST['qru_review_page_url'] );                $options['qru_review_page_url']			= $qru_review_page_url;                $options['last_updated']				= time();                update_option( 'qru_business_options', $options );        }		$options = get_option( 'qru_business_options' );	if( $options != '' ) {				$qru_review_page_url = $options['qru_review_page_url'];		}		require( 'includes/qru-review-page.php' );	}/* * Review Stream Shortcode*/function qru_review_live_stream($atts, $content = null) {    extract(shortcode_atts(array(        "url" => '',		"reviews" => '',		"carousel" => '',		"shuffle" => '',		"aggregate" => ''    ), $atts));    return '<div style="height: auto;" class="reviewmgr-stream" data-carousel="' . $carousel . '" data-shuffle="' . $shuffle . '" data-show-aggregate-rating="' . $aggregate . '" data-review-limit="' . $reviews . '" data-url="' . $url . '"></div><script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.reviewmgr.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document, "script", "reviewmgr-wjs");</script>';}add_shortcode("qru-review-stream", "qru_review_live_stream");/* * Review Page Shortcode*/function qru_review_page($atts, $content = null) {    extract(shortcode_atts(array(        "pageurl" => '',    ), $atts));    return '<div class="reviewmgr-embed" data-url="' . $pageurl . '"></div><script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.reviewmgr.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document, "script", "reviewmgr-wjs");</script>';}add_shortcode("qru-review-page", "qru_review_page");/* * Plugin Admin Styles*/function qru_review_stream_admin_styles($hook) {	global $review_stream_settings;	$qru_business_plugin_url = plugin_dir_url( __FILE__ );      if   ( $hook == $review_stream_settings ) {           wp_enqueue_style( 'qru_admin_styles_bootstrap', $qru_business_plugin_url . 'assets/css/bootstrap.min.css');		  wp_enqueue_style( 'qru_admin_styles', $qru_business_plugin_url . 'assets/css/qru-admin-styles.css');      }}add_action('admin_enqueue_scripts', 'qru_review_stream_admin_styles');function qru_review_page_admin_styles($hook) {	global $review_page_settings;	$qru_business_plugin_url = plugin_dir_url( __FILE__ );      if   ( $hook == $review_page_settings ) {           wp_enqueue_style( 'qru_admin_styles_bootstrap', $qru_business_plugin_url . 'assets/css/bootstrap.min.css');		  wp_enqueue_style( 'qru_admin_styles', $qru_business_plugin_url . 'assets/css/qru-admin-styles.css');      }}add_action('admin_enqueue_scripts', 'qru_review_page_admin_styles');function qru_review_reporting_page_admin_styles($hook) {	global $review_reporting_settings;	$qru_business_plugin_url = plugin_dir_url( __FILE__ );      if   ( $hook == $review_reporting_settings ) {           wp_enqueue_style( 'qru_admin_styles_bootstrap', $qru_business_plugin_url . 'assets/css/bootstrap.min.css');		  wp_enqueue_style( 'qru_admin_styles', $qru_business_plugin_url . 'assets/css/qru-admin-styles.css');      }}add_action('admin_enqueue_scripts', 'qru_review_reporting_page_admin_styles');